language: python
python:
- '2.7'
- '3.4'
- '3.5'
- '3.6'
cache:
  directories:
  - "$HOME/.rpmlint/"
install:
- sudo apt-get install -y lintian
- if [[ $TRAVIS_PYTHON_VERSION != 2.6 ]]; then pip install pylint; fi
- pip install -r requirements.txt
before_script:
- if [[ "$TRAVIS_PYTHON_VERSION" = "2.7" ]]; then export IS_PRIMARY_MATRIX_JOB=true;
  fi
- SEMVER_REGEX="^v(0|[1-9][0-9]*)\.(0|[1-9][0-9]*)\.(0|[1-9][0-9]*)(\-[0-9A-Za-z-]+(\.[0-9A-Za-z-]+)*)?(\+[0-9A-Za-z-]+(\.[0-9A-Za-z-]+)*)?$"
- |
- if [[ "$TRAVIS_TAG" =~ $SEMVER_REGEX ]]; then export PACKAGE_VERSION=${TRAVIS_TAG#v};
  fi
- echo $TRAVIS_TAG
- echo $PACKAGE_VERSION
- echo $IS_PRIMARY_MATRIX_JOB
script:
- python -c "import sys; print('python version:%s' % sys.version);"
- python -c "import sys; print('python version:%s' % sys.version[0]);"
- "./pylint-runner.py -s"
- python setup.py sdist bdist_wheel
before_deploy:
- PACKAGE_DATE=$(git log -1 --pretty="format:%ad" $TRAVIS_TAG --date=short);
- echo $PACKAGE_DATE;
deploy:
- provider: pypi
  user: apptuit.ai
  distributions: sdist bdist_wheel
  on:
    tags: true
    condition: $PACKAGE_VERSION != "" && $IS_PRIMARY_MATRIX_JOB == "true"
  password:
    secure: "uLVveJr1mueBxAnd7M0zjYBKyWeJqfLsJBPpoYGlbydyFH8jpEtGCki9XxsjsHv3C7chq4xFjezYXRcyk6sOmaYFu4+b3zMyuJo1gFKnEEzX6uQnxUBmZBJmPg+8gSYgXtv2blwEoTZI4ILA8mpIYpksdk2ZYrlPC54sYu7ch931LsiTUPor0wKojuguM/Re5kbcnvJcegUz3cZSe0K5XgrM1d1a0X19c6LfV+cg+J+/W9eRR6N/kSTEUl1XCBxwsqDlQFlrSQLEZRkpUVVG0eaCFAD1s19r/7abIqicEIELHHxqWKBspDTG7/pcmzaGJEN9fwzbf9xLyRYo37qaUP4GSU/f8KUCX6o9yuTtJLA6+I1GuZAApdgcB0abpsKKcCMFuH/PLEJTSEC7adDPOlMR3rbz6UiFqT2QKR/pZJR9utY3WlF8MFJMHUzgCZR/OWD2KwgI3h84bjPtr8M08plZbPkbQI7MGn7dDiA5vHt7ocTbflZUdFysudjopfWjRJU8m4mMRzbYY3P5Rtp6qXfRfhxOkwvbVrQmnq90g5VuBdEjuzqvWoQaC+MPqv+UldJcxXOm1hECZskB7dHVGMoNQ7k8iIXYcSMao5Wzq5bVhu10AUwF+59u2ME6polvuO5jukbjFsOMHPYsGfdc3CJ6rOafAdZUB16H22wqWj0="
